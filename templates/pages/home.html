{% extends "base.html" %}
{% load markdown_extras %}
{% load webpack_loader static %}
{% load widget_tweaks %}

{% block content %}

<div class="relative px-6 mt-16 isolate sm:mt-24 lg:px-8">
  <div class="relative px-6 mt-16 isolate sm:mt-24 lg:px-8">
    <div class="mx-auto text-center">
        <h1 class="max-w-2xl mx-auto mb-6 text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl">
          Personalized Job Alerts delivered
          <span class="text-green-500">directly to your inbox</span>
        </h1>
        <div class="flex items-end justify-center mt-10 gap-x-6">
          <form
            action="{% url 'create-alert' %}"
            method="post"
            enctype="multipart/form-data"
            class="flex flex-row items-end space-x-1"
          >
          {% csrf_token %}
            <div>
              <label for="email" class="block text-sm font-medium leading-6 text-left text-gray-900">Email</label>
              {% render_field create_alert_form.email id="email" name="email" type="email" autocomplete="email" placeholder="you@example.com" required="True" class="block w-full px-2 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6" %}
            </div>

            <div>
              <label for="technology_selected" class="block text-sm font-medium leading-6 text-left text-gray-900">Tech</label>
              <div>
                {% render_field create_alert_form.technology_selected list="job-technologies" id="technology_selected" name="technology_selected" type="text" placeholder="Select from the list" required="True" class="block w-full px-2 rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6" %}
                <datalist id="job-technologies">
                  {% for object in popular_technologies %}
                    <option value="{{ object.name }}"></option>
                  {% endfor %}
                </datalist>
              </div>
            </div>

            <button
              type="submit"
              class="block px-3 py-2 text-sm font-semibold text-white bg-green-600 rounded-md shadow-sm hover:bg-green-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600"
            >
              Create Alert
            </button>

          </form>
          <span class="text-xl">or</span>
          <a
            href="{% url 'posts' %}"
            class="block px-3 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600"
          >
            Start Searching
          </a>
        </div>
    </div>
  </div>
</div>

<div class="mx-auto mt-16 overflow-hidden sm:mt-24 max-w-7xl">
  <ul role="list" class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
    {% for object in latest_job_submissions %}
    {% if object.technologies.all.count > 0 or object.jobs.all.count > 0 %}
      <li class="col-span-1 bg-white border border-gray-100 divide-y divide-gray-200 rounded-lg shadow">
          <div class="flex items-center justify-between w-full p-6 space-x-6">
            <div class="flex-1 truncate">
              <div class="flex items-center space-x-3">
                <h3 class="text-lg font-medium text-gray-900 truncate">
                  {{ object.company.name }}
                </h3>
                {% if object.company.company_homepage_link %}
                <a href="{{ object.company.company_homepage_link }}" target="_blank">
                  <img class="w-4 h-4" src="{% static 'vendors/images/external_link.svg' %}" alt="External Link" />
                </a>
                {% endif %}
              </div>
              {% if object.company_job_application_link %}
                <a href="{{ object.split_application_links.0 }}" target="_blank" class="mt-1 text-sm text-gray-500 truncate">Application Link</a>
              {% endif %}
            </div>
          </div>

          {% if object.jobs.all.count > 0 %}
          <div class="flex w-full p-3 -mt-px divide-x divide-gray-200">
            <div class="flex flex-1 w-0">
              <div class="my-2">
                  <h4 class="text-sm">Roles</h4>
                  {% for title in object.jobs.all %}
                  <span class="inline-flex items-center px-2 py-1 my-1 text-sm font-medium text-green-700 rounded-md bg-green-50 ring-1 ring-inset ring-green-600/20">
                    {{ title.name }}
                  </span>
                  {% endfor %}
              </div>
            </div>
          </div>
          {% endif %}

          {% if object.technologies.all.count > 0 %}
          <div class="flex w-full p-3 -mt-px divide-x divide-gray-200">
            <div class="flex flex-1 w-0">
              <div class="my-2">
                  <h4 class="text-sm">Tech Stack</h4>
                  {% for technology in object.technologies.all %}
                  <span class="inline-flex items-center px-2 py-1 my-1 text-sm font-medium text-green-700 rounded-md bg-green-50 ring-1 ring-inset ring-green-600/20">
                    {{ technology.name }}
                  </span>
                  {% endfor %}
              </div>
            </div>
          </div>
          {% endif %}

      </li>
    {% endif %}
    {% endfor %}
  </ul>
</div>

<div class="mx-auto mt-4 mb-16 text-right max-w-7xl">
  <a href="{% url 'posts' %}" class="inline-flex items-center px-6 py-3 text-base font-medium text-white bg-green-600 border border-transparent rounded-md shadow-sm hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
    See more jobs
    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 ml-3 -mr-1 2-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
  </a>
</div>

{% endblock content %}
